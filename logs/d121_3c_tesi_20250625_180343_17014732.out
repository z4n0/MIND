Logging to:   /leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/logs/d121_3c_tesi_20250625_180343_17014732.out
Running on:   lrdn0662.leonardo.local
CUDA visible: 0
Started at:   Wed Jun 25 18:03:43 CEST 2025
──────────────────────────────────────────────
/leonardo/prod/opt/libraries/cineca-ai/4.3.0/none/cineca-ai-env/lib/python3.11/site-packages/transformers/utils/generic.py:462: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  _torch_pytree._register_pytree_node(
torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
2025-06-25 18:04:09.288842: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-06-25 18:04:09.967176: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-25 18:04:09.968327: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-25 18:04:10.069788: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-25 18:04:10.317125: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-06-25 18:04:12.657725: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Configuration loaded from /leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/configs/3c/base.yaml
Configuration: {'dataset': {'class_names': ['MSA', 'PD']}, 'data_splitting': {'random_seed': 42, 'val_set_size': 0.2, 'test_set_size': 0.1, 'num_folds': 6}, 'data_augmentation': {'resize_spatial_size': [256, 256], 'rand_flip_prob': 0.3, 'rand_flip_spatial_axes': [0, 1], 'rand_rotate90_prob': 0.3, 'rand_rotate90_max_k': 3, 'rand_gaussian_noise_prob': 0.4, 'rand_gaussian_noise_mean': 0.0, 'rand_gaussian_noise_std': 0.1}, 'data_loading': {'batch_size': 8, 'num_workers': 0}, 'model': {'model_name': 'base', 'spatial_dims': 2, 'in_channels': 3, 'out_channels': 2, 'dropout_prob': 0.1, 'library': 'monai'}, 'training': {'num_epochs': 50, 'early_stopping_patience': 17, 'mixup_alpha': 0, 'oversample': True, 'undersample': False, 'weighted_loss': False, 'fine_tuning': False, 'transfer_learning': True, 'freezed_layerIndex': None}, 'optimizer': {'learning_rate': '1e-4', 'optimizer_name': 'Adam', 'weight_decay': '2e-5'}, 'scheduler': {'scheduler_name': 'ReduceLROnPlateau', 'factor': 0.5, 'scheduler_patience': 9, 'threshold': '1e-4', 'min_lr': '1e-8'}}
Configuration loaded from /leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/configs/3c/densenet121.yaml
Configuration: {'dataset': {'class_names': ['MSA', 'PD']}, 'class_names': None, 'data_splitting': {'random_seed': 42, 'val_set_size': 0.15, 'test_set_size': 0.1, 'num_folds': 7}, 'data_augmentation': {'resize_spatial_size': [256, 256], 'rand_flip_prob': 0.3, 'rand_flip_spatial_axes': [0, 1], 'rand_rotate90_prob': 0.3, 'rand_rotate90_max_k': 3, 'rand_gaussian_noise_prob': 0.4, 'rand_gaussian_noise_mean': 0.0, 'rand_gaussian_noise_std': 0.1, 'use_color_transforms': False}, 'data_loading': {'batch_size': 32, 'num_workers': 2}, 'model': {'model_name': 'Densenet121', 'spatial_dims': 2, 'in_channels': 3, 'out_channels': 2, 'dropout_prob': 0.1, 'library': 'monai', 'pretrained_weights': 'imagenet'}, 'training': {'num_epochs': 125, 'early_stopping_patience': 40, 'mixup_alpha': 0, 'oversample': True, 'undersample': False, 'weighted_loss': False, 'fine_tuning': False, 'transfer_learning': False, 'freezed_layerIndex': None, 'pretrained': True}, 'optimizer': {'learning_rate': '2e-4', 'optimizer_name': 'AdamW', 'weight_decay': '1e-4', 'patience': 25}, 'scheduler': {'scheduler_name': 'ReduceLROnPlateau', 'factor': 0.5, 'scheduler_patience': 9, 'threshold': '1e-4', 'min_lr': '1e-8'}, 'num_epochs': None, 'freeze_layers': None, 'pretrained_weights': None}
Using configuration: configs/3c/densenet121.yaml
Class names: ['MSA', 'PD']
Traceback (most recent call last):
  File "/leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/train.py", line 195, in <module>
    main()
  File "/leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/train.py", line 104, in main
    DATA_ROOT         = get_data_directory(num_channels)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/train.py", line 67, in get_data_directory
    raise FileNotFoundError(f"Cartella dati non trovata: {data_dir}")
FileNotFoundError: Cartella dati non trovata: /leonardo_work/pMI24_EleBr_1/lzanotto/FOLDER_CINECA/data/3c_MIP
srun: error: lrdn0662: task 0: Exited with exit code 1
